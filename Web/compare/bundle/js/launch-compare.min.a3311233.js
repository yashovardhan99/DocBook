(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
var Package={Compare:{Config:require("./module/config"),Page:require("./module/page"),Drug:require("./module/drug"),Suggest:require("./module/suggest"),Search:require("./module/search")}};!function(){$.ajaxSetup({type:"GET",cache:!0,dataType:"json",timeout:6e4}),Package.Compare.Drug.init(),Package.Compare.Config.init(),Package.Compare.Suggest.init(),Package.Compare.Search.init(),Package.Compare.Page.init()}();
},{"./module/config":2,"./module/drug":3,"./module/page":4,"./module/search":5,"./module/suggest":6}],2:[function(require,module,exports){
function init(){Package.Debug.trace("DDC.Compare.Config.init")}function constant(){return{suggestions:{limit:5,drugs:{limit:6}}}}module.exports={init:init,constant:constant};var Package={Debug:window.DDC.Debug};
},{}],3:[function(require,module,exports){
function init(){Package.Debug.trace("DDC.Compare.Drug.init"),$("#compare-wrap").on("click","[data-action=expand]",expand),_data=Package.Config.get(["compareApp","context"]),_data&&_data.compare&&cacheData(_data.compare.drugs),compress()}function get(){Package.Debug.trace("DDC.Compare.Drug.get"),$("#compare-wrap").addClass("drug-loading");var e=Package.Config.site().compareApp.api.compare.drugs.url;e+="?drugs="+Package.Compare.Page.getUrlDrugs();var a=getCachedData();a&&(_data=a,render(),!a.compare.isLoading)||Package.Api.get(e).then(initData).catch(handleError)}function getPageTitle(){var e=Package.Compare.Page.getUrlDrugKeys();return e.forEach(function(a,r){var t=_cache[a];t&&t.short_name?e[r]=Package.Helper.String.ucWords(t.short_name):e[r]=Package.Helper.String.ucWords(a.replace(REPLACE_PATTERN," "))}),"Comparing "+e.join(" vs ")}function handleError(){Package.Debug.trace("DDC.Compare.Drug.handleError"),$("#compare-wrap").removeClass("drug-loading")}function render(){Package.Debug.trace("DDC.Compare.Drug.render"),$("#compare-wrap").removeClass("drug-loading"),dust.render("partial-drug",_data,function(e,a){if(e)throw e;if($("#compare-drugs").html(a),$("#compare-title, #header-compare-title").text(_data.compare.title),Package.Compare.Page.initSelectors(),Package.Compare.Page.resize(),document.title=_data.compare.title,window.btoa)try{Package.Config.site().share.url=window.btoa(window.location.href).replace(/=/g,".")}catch(e){}Package.Compare.Suggest.render(),compress()})}function compress(){Package.Debug.trace("DDC.Compare.Drug.compress"),$(".comment").each(function(){var e=$(this),a=e.text().trim(),r=shorten(a,30);if(a.length!==r.length){e.text(r+"... ");var t=$("<a></a>").attr("href","#").attr("data-action","expand").html('<span class="sr-only">View </span>more');e.append(t).addClass("has-more").attr("data-more",a)}})}function shorten(e,a){return Package.Debug.trace("DDC.Compare.Drug.shorten"),e.split(" ",a).join(" ")}function initData(e){Package.Debug.trace("DDC.Compare.Drug.initData"),e&&e.drugs&&e.drugs.length&&(e.drugs.forEach(function(e){e.price_product_doses&&e.price_product_doses.forEach(function(e){e.min_price=Number(e.min_price).toFixed(2),e.min_price_unit=Number(e.min_price_unit).toFixed(2)}),!isNaN(e.review.average)&&e.review.average>0&&(e.review.average=Number(e.review.average).toFixed(1)),e.sfx&&(initSfx(e.sfx.common),initSfx(e.sfx.frequent),initSfx(e.sfx.less_frequent),initSfx(e.sfx.rare))}),cacheData(e.drugs),_data={compare:{drugs:e.drugs,title:getPageTitle()}},render())}function initSfx(e){if(Package.Debug.trace("DDC.Compare.Drug.initSfx"),e){var a=e.length;a>1&&(e[a-1].adverse_effect="and "+e[a-1].adverse_effect)}}function cacheData(e){Package.Debug.trace("DDC.Compare.Drug.cacheData"),e&&e.length&&e.forEach(function(e){_cache[e.url]=e})}function getCachedData(){Package.Debug.trace("DDC.Compare.Drug.getCachedData");var e=Package.Compare.Page.getUrlDrugKeys(),a=[],r=!1;if(e.forEach(function(e){if(_cache[e])a.push(_cache[e]);else{r=!0;var t=Package.Helper.String.ucWords(e.replace(REPLACE_PATTERN," "));a.push({ddc_id:0,url:e,brand_name_id:0,short_name:t,title_name:t,generic_name:"Loading...",isLoading:r})}}),e.length===a.length)return{compare:{drugs:a,title:getPageTitle(),isLoading:r}}}function getDrugKeys(){Package.Debug.trace("DDC.Compare.drug.getDrugKeys");var e=[];return _data&&_data.compare&&_data.compare.drugs&&_data.compare.drugs.forEach(function(a){e.push(a.url)}),e}function expand(e){Package.Debug.trace("DDC.Compare.drug.expand"),e.preventDefault(),e.stopPropagation();var a=$(e.target).closest(".has-more"),r=a.attr("data-more");r&&a.html(r)}module.exports={init:init,get:get,getPageTitle:getPageTitle,getDrugKeys:getDrugKeys};var Package={Api:window.DDC.Api,Config:window.DDC.Config,Debug:window.DDC.Debug,Helper:window.DDC.Helper,Compare:{Config:require("./config"),Suggest:require("./suggest"),Page:require("./page")}},_data=null,_cache={},REPLACE_PATTERN=new RegExp("-","g");
},{"./config":2,"./page":4,"./suggest":6}],4:[function(require,module,exports){
function init(){if(Package.Debug.trace("DDC.Compare.Page.init"),_$document=$(document),_$compareWrap=$("#compare-wrap"),_$content=$("#container"),0===_$compareWrap.length)return void(_$compareWrap=null);initSelectors(),_$compareWrap.on("click","[data-action=add]",onAddDrugKey).on("click","[data-action=remove]",onRemoveDrugKey).on("click","[data-action=ga]",trackEvent).on("scroll",compareScrolling);var e=$("#compareScrollLeft");e.on("mousedown",function(e){e.preventDefault(),e.stopPropagation(),scroll(-1)});var r=$("#compareScrollRight");r.on("mousedown",function(e){e.preventDefault(),e.stopPropagation(),scroll(1)}),_caretTop=e.position().top+r.height(),Package.Scroller.attach(pageScrolling),_$document.scroll(),$(window).on("popstate",reload).on("resize",resize),resize()}function initSelectors(){Package.Debug.trace("DDC.Compare.Page.initSelectors"),_$compareTable=$("#compare-table"),_$subtitles=$(".compare-table h3")}function reload(){Package.Debug.trace("DDC.Compare.Page.reload"),_isModified=!0;var e=getUrlDrugKeys();Package.Compare.Drug.get(),e.length>=Package.Config.site().compareApp.drugs.limit?(_$compareWrap.addClass("compare-drugs-limit"),$("#compare-suggest").html("")):_$compareWrap.removeClass("compare-drugs-limit"),compareScrolling(),$(window).resize(),Package.Compare.Suggest.get()}function pageScrolling(e,r){var a=r.scrollY;_$content.toggleClass("absolute",a>_absoluteTop).toggleClass("fixedHead",a>_fixedTop)}function scroll(e){var r=_$compareWrap.scrollLeft()+250*e;_$compareWrap.animate({scrollLeft:r},400,compareScrolling)}function setHorizontalScroll(){var e=_$compareWrap.scrollLeft();_$content.toggleClass("hasCompareRight",e<_compareTableWidth),_$content.toggleClass("hasCompareLeft",e>0),_$subtitles.css({left:e})}function resize(){Package.Debug.trace("DDC.Compare.Page.resize");var e=_$compareWrap.offset().top,r=_$compareWrap.outerHeight(!0);_absoluteTop=e+r-_caretTop-50,_fixedTop=e+$("#compare-table-header").height(),_compareTableWidth=_$compareTable.innerWidth()-_$compareWrap.innerWidth(),compareScrolling(),$("#compare-table-fixed-container").css({width:_$compareWrap.width(),left:_$content.offset().left})}function compareScrolling(){$("#compare-table-fixed").css({marginLeft:-1*_$compareWrap.scrollLeft()}),window.clearTimeout(_checkTimeout),_checkTimeout=window.setTimeout(setHorizontalScroll,50)}function onAddDrugKey(e){Package.Debug.trace("DDC.Compare.Page.onAddDrugKey"),e.preventDefault(),e.stopPropagation(),addDrugKey($(e.target).closest("[data-action]").attr("data-drug-key"))}function addDrugKey(e){var r=getUrlDrugKeys();r.includes(e)||r.push(e),setUrlDrugKeys(r),$("html, body").animate({scrollTop:_$content.offset().top},500)}function onRemoveDrugKey(e){Package.Debug.trace("DDC.Compare.Page.onRemoveDrugKey"),e.preventDefault(),e.stopPropagation(),removeDrugKey($(e.target).closest("[data-action]").attr("data-drug-key"))}function removeDrugKey(e){Package.Debug.trace("DDC.Compare.Page.removeDrugKey");var r=getUrlDrugKeys(),a=r.indexOf(e);a>-1&&r.splice(a,1),setUrlDrugKeys(r)}function getUrlDrugKeys(){Package.Debug.trace("DDC.Compare.Page.getUrlDrugKeys");var e=window.location.href.toLowerCase(),r="compare/",a=e.lastIndexOf(r)+r.length;if(a<0&&(r="drugs=",a=e.lastIndexOf(r)+r.length),a<0)return[];e=e.substring(a);var o=e.lastIndexOf("#");o>0&&(e=e.substring(0,o)),(o=e.lastIndexOf("?"))>0&&(e=e.substring(0,o));var t=e.split(URL_DELIMITER);t=t.filter(function(e){return e.length>0}),1!==t.length||_isModified||(t=Package.Compare.Drug.getDrugKeys());for(var n=Package.Config.site().compareApp.drugs.limit;t.length>n;)t.pop();return t}function getUrlDrugs(e){return Package.Debug.trace("DDC.Compare.Page.getUrlDrugs"),getUrlDrugKeys().join(e||URL_DELIMITER)}function setUrlDrugKeys(e){if(Package.Debug.trace("DDC.Compare.Page.setUrlDrugKeys"),e=e.filter(function(e){return e.length>0}),e.length>Package.Config.site().compareApp.drugs.limit)return void window.location.reload();if(0===e.length)return void(window.location.href=BASE_URL);var r=BASE_URL+e.join(URL_DELIMITER);window.history.pushState?(track(r),window.history.pushState({},Package.Compare.Drug.getPageTitle(),r),reload()):window.location.href=r}function track(e){"function"==typeof window.ga&&window.ga("send","pageview",e)}function trackEvent(e){if("function"==typeof window.ga){var r=$(e.target).closest("[data-action=ga]");window.ga("send","event","Comparison Tool",r.attr("data-event"),r.attr("data-drug-key"),{nonInteraction:1})}}module.exports={init:init,initSelectors:initSelectors,resize:resize,addDrugKey:addDrugKey,getUrlDrugs:getUrlDrugs,getUrlDrugKeys:getUrlDrugKeys};var Package={Config:window.DDC.Config,Debug:window.DDC.Debug,Helper:window.DDC.Helper,Scroller:window.DDC.Scroller,Compare:{Config:require("./config"),Suggest:require("./suggest"),Drug:require("./drug")}},URL_DELIMITER="-vs-",BASE_URL="/compare/",_$document=null,_$compareWrap=null,_$content=null,_$compareTable=null,_$subtitles=null,_compareTableWidth=0,_absoluteTop=0,_fixedTop=0,_caretTop,_checkTimeout=0,_isModified=!1;
},{"./config":2,"./drug":3,"./suggest":6}],5:[function(require,module,exports){
(function (process){
function init(){Package.Debug.trace("DDC.Compare.Search.init"),$(".compare-search").on("focus","input.input-text",initSearchField).on("focusout","input.input-text",hideResults).on("keyup",".livesearchCompare",handleInput).on("submit","form",handleAdd)}function initSearchField(e){Package.Debug.trace("DDC.Compare.Search.initSearchField"),_search.$field&&(_search.$field.hide().html(""),_search.$field=null),loading(!1),$(".livesearchCompare").val(_search.text=""),$(e.target).closest("form").find(".compare-search-result").show()}function handleAdd(e){Package.Debug.trace("DDC.Compare.Search.handleAdd"),e.preventDefault(),e.stopPropagation(),select(ACTIONS.ADD)}function hideResults(){Package.Debug.trace("DDC.Compare.Search.hideResults"),setTimeout(function(){loading(!1),$(".compare-search").removeClass("showsearch"),_search.$field&&_search.$field.html("")},1e3)}function handleInput(e){switch(Package.Debug.trace("DDC.Compare.Search.handleInput"),e.preventDefault(),e.stopPropagation(),e.which){case 38:return void select(ACTIONS.UP);case 40:return void select(ACTIONS.DOWN);case 13:return void select(ACTIONS.ADD)}loading(!0),window.clearTimeout(_timer.search),_timer.search=window.setTimeout(function(){process(e.target)},_timer.delay)}function select(e){if(Package.Debug.trace("DDC.Compare.Search.select"),!_search.$field)return void loading(!1);var a=_search.$field.find(".search-suggest-focus");switch(e){case ACTIONS.ADD:add(a);break;case ACTIONS.UP:next(a,a.length?a.prev():_search.$field.find(".search-suggest-item:last"));break;case ACTIONS.DOWN:next(a,a.length?a.next():_search.$field.find(".search-suggest-item:first"))}}function add(e){if(Package.Debug.trace("DDC.Compare.Search.add"),e.length)e[0].click();else if(_search.loading)_search.submit=!0;else{if(!_search.$field||_search.templateError)return loading(!1),void Package.Compare.Page.addDrugKey(_search.text);var a=_search.$field.find("[data-exact=1]");1===a.length&&a[0].click()}}function next(e,a){Package.Debug.trace("DDC.Compare.Search.next"),e.removeClass("search-suggest-focus"),a.addClass("search-suggest-focus")}function process(e){Package.Debug.trace("DDC.Compare.Search.process");var a=$(e),r=a.closest(".livesearchCompare").val().trim(),t=a.closest("form"),c=t.find(".compare-search-result"),s=t.attr("data-search");if(!r.length)return $(".compare-search").removeClass("showsearch"),c.html(""),loading(!1),void(_search.$field=null);r!==_search.text&&(_search.$field=c,apiSearch(r,s))}function apiSearch(e,a){Package.Debug.trace("DDC.Compare.Search.apiSearch",e,a),_search.text=e;var r=Package.Config.site().compareApp.api.compare.search.url;r+="?q="+e+"&limit=8&offset=0",Package.Api.get(r).then(displayResults).catch(handleError)}function loading(e){Package.Debug.trace("DDC.Compare.Search.loading"),_search.loading=e,$("#compare-wrap").toggleClass("search-suggest-loading",e)}function handleError(){Package.Debug.trace("DDC.Compare.Search.handleError"),loading(!1)}function displayResults(e){if(Package.Debug.trace("DDC.Compare.Search.displayResults"),!e||!e.items||!e.items.length)return void $(".compare-search").removeClass("showsearch");initData(e),e.items.length&&(_search.results=e),dust.render("partial-search-item",_search.results,render)}function render(e,a){if(Package.Debug.trace("DDC.Compare.Search.render"),loading(!1),e){if(e.message&&e.message.match(/^Template Not Found/))return Package.Debug.trace("DDC.Compare.Search.render Error",e.message),void(_search.templateError=!0);throw e}_search.templateError=!1,$(".compare-search").addClass("showsearch"),_search.$field&&_search.$field.html(a),_search.submit&&(_search.submit=!1,select(ACTIONS.ADD))}function initData(e){Package.Debug.trace("DDC.Compare.Search.initData");for(var a=e.items,r=a.length-1;r>=0;r--){var t=a[r];t.url?t.generic_name&&t.generic_name===t.description+" systemic"&&(t.generic_name=""):a.splice(r,1)}}module.exports={init:init};var Package={Api:window.DDC.Api,Config:window.DDC.Config,Debug:window.DDC.Debug,Compare:{Config:require("./config"),Page:require("./page")}},ACTIONS={UP:0,DOWN:1,ADD:2},_timer={search:0,delay:100},_search={text:null,result:null,submit:!1,loading:!1,$field:null,templateError:!1};
}).call(this,require('_process'))

},{"./config":2,"./page":4,"_process":7}],6:[function(require,module,exports){
function init(){Package.Debug.trace("DDC.Compare.Suggest.init"),_adTargets=Package.Config.get(["compareApp","ads","targets"]),$("#compare-suggest").length&&injectAd()}function get(){Package.Debug.trace("DDC.Compare.Suggest.get");var e=Package.Compare.Page.getUrlDrugKeys(),a=Package.Compare.Page.getUrlDrugs();if(_previousUrl!==a&&(_previousUrl=a,e.length>0&&e.length<Package.Config.site().compareApp.drugs.limit)){$("#compare-wrap").addClass("suggest-loading"),clear();var t=Package.Config.site().compareApp.api.compare.conditions.url;t+="?drugs="+Package.Compare.Page.getUrlDrugs(),_data=null,Package.Api.get(t).then(initData).catch(handleError)}}function clear(){Package.Debug.trace("DDC.Compare.Suggest.clear"),$("#compare-suggest").html("")}function handleError(){Package.Debug.trace("DDC.Compare.Suggest.handleError"),$("#compare-wrap").removeClass("suggest-loading")}function render(){Package.Debug.trace("DDC.Compare.Suggest.render"),$("#compare-wrap").removeClass("suggest-loading"),_data&&dust.render("partial-suggest",_data,function(e,a){if(e){if(e.message&&e.message.match(/^Template Not Found/))return void Package.Debug.trace("DDC.Compare.Suggest.render Error",e.message);throw e}$("#compare-suggest").html(a),injectAd()})}function initData(e){Package.Debug.trace("DDC.Compare.Suggest.initData"),e&&e.conditions&&e.conditions.length&&(_data=e,initConditions(),render())}function initConditions(){Package.Debug.trace("DDC.Compare.Suggest.initConditions");for(var e=_data.conditions,a=Package.Compare.Config.constant().suggestions.limit,t=0;t<e.length;t++)filterDrugs(e[t],e.length>1),e[t].show_condition=t<a;_data.hasMoreConditions=e.length>a}function filterDrugs(e,a){Package.Debug.trace("DDC.Compare.Suggest.filterDrugs");var t=Package.Compare.Config.constant().suggestions.drugs.limit,g=Package.Compare.Page.getUrlDrugs()+URL_DELIMITER,r=Package.Compare.Page.getUrlDrugKeys(),n=r.length>1;e.drugs.forEach(function(e,r){e.show=!a||r<t,e.href=g+e.url,e.noFollow=n||e.noFollow,e.name=ufirst(e.name)}),e.hasMoreDrugs=a&&e.drugs.length>t}function injectAd(){if(Package.Debug.trace("DDC.Compare.Suggest.injectAd"),_adTargets)for(var e=0;e<_adTargets.length;e++){var a=_adTargets[e],t={id:a.id,channel:a.channel,client:a.client,type:a.type,width:a.width,height:a.height},g=Package.Ads.Injection.buildAdHtml(t);$(a.container).html(g),Package.Ads.Injection.loadAd(t)}}function ufirst(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e}module.exports={init:init,get:get,render:render};var Package={Ads:window.DDC.Ads,Api:window.DDC.Api,Config:window.DDC.Config,Debug:window.DDC.Debug,Compare:{Config:require("./config"),Page:require("./page")}},URL_DELIMITER="-vs-",_data=null,_previousUrl=null,_adTargets=null;
},{"./config":2,"./page":4}],7:[function(require,module,exports){
function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}var process=module.exports={},cachedSetTimeout,cachedClearTimeout;!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var queue=[],draining=!1,currentQueue,queueIndex=-1;process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(e){return[]},process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};
},{}]},{},[1])


//# sourceMappingURL=./launch-compare.min.js.map